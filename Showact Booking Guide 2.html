<!DOCTYPE html>
<html lang="de">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover" />
  <title>Show Booking Guide – Chris Cross</title>
  <style>
    :root{
      --bg:#0b0b0c;--fg:#f4f4f5;--muted:#a1a1aa;--accent:#22c55e;--stroke:#1e1e21;--glass:#0000005c;
    }
    *{box-sizing:border-box}
    html,body{margin:0;height:100%;background:var(--bg);color:var(--fg);font-family:ui-sans-serif,system-ui,-apple-system,Segoe UI,Roboto,Inter,Helvetica,Arial}
    a{color:inherit}

    /* ===== FULL-BLEED STAGE (Step View) ===== */
    #stage{position:relative;width:100vw;height:100vh;overflow:hidden;display:none;background:#000}
    #stage.active{display:block}
    .gallery{position:absolute;inset:0;display:flex;gap:0;overflow:hidden}
    .gallery.vertical{flex-direction:column;overflow-y:auto;-webkit-overflow-scrolling:touch}
    .option{flex:1 1 0;position:relative;cursor:pointer;outline:none}
    .option img{width:100%;height:100%;object-fit:cover;display:block;transition:transform .18s ease-out;will-change:transform}
    .option:hover img{transform:scale(1.05)}
    .option:focus-visible img{transform:scale(1.05)}

    /* Centered overlay content on image */
    .opt-center{position:absolute;left:50%;top:50%;transform:translate(-50%,-50%);text-align:center;display:flex;flex-direction:column;align-items:center;gap:8px;pointer-events:none}
    .opt-box{background:#000000cc;backdrop-filter:saturate(140%) blur(4px);border-radius:16px;box-shadow:0 0 0 1px #ffffff22;padding:12px 16px;max-width:min(86vw,680px)}
    .opt-title{font-weight:900;font-size:clamp(20px,4.4vw,38px);line-height:1.05;margin:0}
    .opt-desc{margin-top:6px;font-size:clamp(14px,2.6vw,17px);color:#e4e4e7;text-shadow:0 1px 2px #0009}

    /* Sticky question at the very top – bold + uppercase + solid black */
    .question{position:fixed;z-index:7;top:calc(env(safe-area-inset-top,0px));left:0;right:0;display:flex;justify-content:center;pointer-events:none}
    .question .q-wrap{margin:8px auto 0;background:#000;border:1px solid #1f1f1f;box-shadow:0 2px 20px #000c;border-radius:14px;padding:14px 20px;font-weight:900;letter-spacing:.3px;text-transform:uppercase;font-size:clamp(20px,3.4vw,30px);}

    /* Corner Controls */
    .corner{position:fixed;z-index:8;display:flex;gap:8px}
    .corner.left{top:calc(env(safe-area-inset-top,0px) + 10px);left:8px}
    .corner.right{top:calc(env(safe-area-inset-top,0px) + 10px);right:8px}
    .btn{appearance:none;border:1px solid #ffffff26;background:#0000009c;backdrop-filter:saturate(140%) blur(4px);color:var(--fg);border-radius:999px;padding:8px 12px;cursor:pointer}

    /* Progress Dots bottom center */
    .progress{position:fixed;z-index:6;bottom:8px;left:50%;transform:translateX(-50%);display:flex;gap:8px}
    .dot{width:8px;height:8px;border-radius:50%;background:#2a2a2f;border:1px solid #313137}
    .dot.active{background:var(--accent);border-color:var(--accent)}

    /* ===== RESULTS (padded content) ===== */
    #results{display:none}
    .wrap{max-width:1100px;margin:0 auto;padding:24px}

    .step.center h1{margin:0 0 10px;text-align:center;text-transform:uppercase;letter-spacing:.4px;font-size:clamp(22px,3.2vw,34px)}
    .step.center p{color:#a1a1aa;text-align:center;margin:0 0 18px}

    .grid{display:grid;grid-template-columns:repeat(3,1fr);gap:16px}
    @media (max-width:900px){.grid{grid-template-columns:repeat(2,1fr)}}
    @media (max-width:640px){.grid{grid-template-columns:1fr}}

    .card{background:#141417;border:1px solid var(--stroke);border-radius:16px;overflow:hidden;display:flex;flex-direction:column}
    .media{position:relative;aspect-ratio:16/9;background:#0f0f12}
    .media img{position:absolute;inset:0;width:100%;height:100%;object-fit:cover}
    .badge{position:absolute;left:10px;top:10px;background:#000a;border:1px solid #ffffff24;border-radius:999px;padding:6px 10px;font-size:12px}
    .content{padding:14px 16px 16px}
    .title{font-size:18px;margin:0 0 6px}
    .desc{color:#a1a1aa;font-size:14px;margin:0}
    .summary{display:flex;gap:8px;flex-wrap:wrap;margin-top:8px}
    .chip{font-size:12px;border:1px solid var(--stroke);color:#d4d4d8;border-radius:999px;padding:4px 8px}
    .nav{display:flex;justify-content:space-between;align-items:center;margin:12px 0 28px}
    .btn.primary{background:var(--accent);border-color:transparent;color:#072a12;font-weight:700}

    .panel{background:#141417;border:1px solid var(--stroke);border-radius:16px;padding:16px}
    .panel h2{margin:0 0 10px;font-size:20px}
    .panel.slim{background:#0f0f12;border-color:#232327;padding:12px;border-radius:12px}
    .panel.slim h2{font-size:16px;font-weight:700;margin:0 0 8px}

    .form-row{display:flex;flex-direction:column;gap:8px;margin:10px 0}
    label{font-size:14px;color:#d4d4d8}
    input[type="email"],textarea{width:100%;padding:12px 14px;border-radius:12px;border:1px solid var(--stroke);background:#111114;color:#f7f7f9}
    .hint{color:#a1a1aa;font-size:12px}
    .success{display:none;background:#0f2619;border:1px solid #134e2a;color:#d1fae5;padding:14px;border-radius:12px;margin-top:10px}
    .error{display:none;background:#2a1111;border:1px solid #6b1d1d;color:#fee2e2;padding:14px;border-radius:12px;margin-top:10px}

    .footer-note{margin-top:16px;color:#a1a1aa;font-size:12px}
  </style>
</head>
<body>
  <!-- FULL-BLEED STEP STAGE -->
  <section id="stage" class="active" aria-live="polite"></section>

  <!-- RESULTS -->
  <section id="results">
    <div class="wrap">
      <div class="step center">
        <h1>Ihre Empfehlung</h1>
        <p>Basierend auf Ihren Antworten haben wir passende Shows für Sie ausgewählt.</p>
      </div>
      <div id="rec-grid" class="grid"></div>

      <!-- Kleine Auswahl-Box unter den Empfehlungen -->
      <div class="panel slim" style="margin-top:16px">
        <h2>Ihre Auswahl</h2>
        <div id="chosen" class="summary"></div>
      </div>

      <!-- Danach direkt die Mail/Anfrage -->
      <div class="panel" style="margin-top:16px">
        <h2>Wie möchten Sie ein unverbindliches Angebot erhalten?</h2>
        <form id="offer-form" novalidate>
          <div class="form-row">
            <label for="email">E-Mail für das Angebot <span class="hint">(Pflichtfeld)</span></label>
            <input type="email" id="email" name="email" required placeholder="z. B. max.mustermann@example.com" />
            <div class="hint">Wir nutzen Ihre E-Mail ausschließlich zur Beantwortung Ihrer Anfrage.</div>
          </div>
          <div class="form-row">
            <label for="message">Zusatzinfos (optional)</label>
            <textarea id="message" name="message" rows="4" placeholder="Ort, Datum, Uhrzeit, Bühne/Location, Besonderheiten…"></textarea>
          </div>
          <input type="text" name="company" id="company" style="display:none" tabindex="-1" autocomplete="off" />

          <div class="nav">
            <button class="btn primary" type="submit">Unverbindliches Angebot anfordern</button>
            <button class="btn" type="button" id="mailto-btn">oder per E-Mail anfragen</button>
            <div class="summary" aria-live="polite"><span class="chip" id="selection-count">0 ausgewählt</span></div>
          </div>

          <div id="success" class="success" role="status">Vielen Dank! Wir kümmern uns zeitnah um Ihre Anfrage.</div>
          <div id="error" class="error" role="alert">Ups – das hat nicht geklappt. Bitte prüfen Sie Ihre Eingaben oder versuchen Sie es per E-Mail.</div>
        </form>
        <p class="footer-note">Direktkontakt: <a href="mailto:info@chriscross.at">info@chriscross.at</a> · Tel. +43 650 92 555 11</p>
      </div>
    </div>
  </section>

  <script>
    // ==============================
    // KONFIGURATION
    // ==============================
    const FORM_ENDPOINT = ""; // z. B. Formspree/Netlify/Apps Script
    const FALLBACK_EMAIL = "info@chriscross.at";
    const pic = (seed) => `https://picsum.photos/seed/${encodeURIComponent(seed)}/1600/900`;

    // Show-Daten (aus Tabelle, leicht normalisiert)
    const SHOWS = [
      {id:'urban-solo', title:'Urban Dance Solo Show', maxDancers:1, technik:'Nein', individual:'Nein', budget:'Klein', fertige:true, laenge:'Kurz', anforderungen:'Wenig', spontan:true, art:'Gemischt', img:"https://raw.githubusercontent.com/ChrisCrossAT/website/main/urban-dance-solo-16x9-1600w.avif", video:'#'},
      {id:'urban-group', title:'Urban Dance Group Show', maxDancers:30, technik:'Nein', individual:'Ja', budget:'Mittel', fertige:true, laenge:'Lang', anforderungen:'Wenig', spontan:false, art:'Gemischt', img:"https://raw.githubusercontent.com/ChrisCrossAT/website/main/urban-dance-group-16x9-1600w.avif", video:'#'},
      {id:'mapping-solo', title:'Mapping Dance Show', maxDancers:1, technik:'Ja', individual:'Ja', budget:'Mittel', fertige:true, laenge:'Lang', anforderungen:'Etwas', spontan:true, art:'Gemischt', img:"https://raw.githubusercontent.com/ChrisCrossAT/website/main/mapping-dance-16x9-1600w.avif", video:'#'},
      {id:'laser-solo', title:'Laser Show', maxDancers:1, technik:'Ja', individual:'Nein', budget:'Hoch', fertige:true, laenge:'Mittel', anforderungen:'Hoch', spontan:false, art:'Wow-Effekt', img:"https://raw.githubusercontent.com/ChrisCrossAT/website/main/laser-16x9-1600w.avif", video:'#'},
      {id:'led-group', title:'LED Group Dance Show', maxDancers:10, technik:'Ja', individual:'Ja', budget:'Mittel', fertige:true, laenge:'Lang', anforderungen:'Etwas', spontan:false, art:'Wow-Effekt', img:"https://raw.githubusercontent.com/ChrisCrossAT/website/main/led-group-16x9-1600w.avif", video:'#'},
      {id:'led-solo', title:'LED Solo Dance Show', maxDancers:1, technik:'Ja', individual:'Ja', budget:'Klein', fertige:false, laenge:'Mittel', anforderungen:'Wenig', spontan:true, art:'Gemischt', img:"https://raw.githubusercontent.com/ChrisCrossAT/website/main/led-solo-16x9-1600w.avif", video:'#'},
      {id:'custom', title:'Maßgeschneiderte Show', maxDancers:30, technik:'Beides', individual:'Ja', budget:'Hoch', fertige:false, laenge:'Lang', anforderungen:'Wenig', spontan:false, art:'Gemischt', img:"https://raw.githubusercontent.com/ChrisCrossAT/website/main/tailor-made-16x9-1600w.avif", video:'#'},
      {id:'lederhose', title:'Lederhose meets Breakdance', maxDancers:12, technik:'Nein', individual:'Ja', budget:'Mittel', fertige:true, laenge:'Mittel', anforderungen:'Wenig', spontan:false, art:'Wow-Effekt', img:"https://raw.githubusercontent.com/ChrisCrossAT/website/main/lederhose-breakdance-16x9-1600w.avif", video:'#'},
      {id:'breaking', title:'Breaking Show', maxDancers:8, technik:'Nein', individual:'Ja', budget:'Mittel', fertige:true, laenge:'Mittel', anforderungen:'Wenig', spontan:false, art:'Wow-Effekt', img:"https://raw.githubusercontent.com/ChrisCrossAT/website/main/breaking-16x9-1600w.avif", video:'#'}
    ];

    // Schritte (ghost-Optionen als Button in der Ecke)
    const STEPS = [
      { id:'team', q:'Wie viele Künstler:innen sind gewünscht?', options:[
          {label:'Solo', value:'Solo', desc:'Ein/e Künstler:in', img:"https://raw.githubusercontent.com/ChrisCrossAT/website/main/solo-16x9-1600w.avif"},
          {label:'Duo–Trio', value:'DuoTrio', desc:'2–3 Artists', img:"https://raw.githubusercontent.com/ChrisCrossAT/website/main/duo-trio-16x9-1600w.avif"},
          {label:'Gruppe (4+)', value:'Group4', desc:'ab 4 Artists', img:"https://raw.githubusercontent.com/ChrisCrossAT/website/main/group-16x9-1600w.avif"},
          {label:'Offen', value:'Offen', ghost:true}
      ]},
      { id:'tech', q:'Wie soll die Show wirken?', options:[
          {label:'High-Tech Visuals', value:'HighTech', desc:'Laser/LED/Mapping', img:"https://raw.githubusercontent.com/ChrisCrossAT/website/main/high-tech-16x9-1600w.avif"},
          {label:'Tanz pur', value:'NoTech', desc:'ohne Spezialtechnik', img:"https://raw.githubusercontent.com/ChrisCrossAT/website/main/pure-dance-16x9-1600w.avif"},
          {label:'Offen', value:'Offen', ghost:true}
      ]},
      { id:'time', q:'Wann ist die Veranstaltung?', options:[
          {label:'< 1 Monat', value:'lt1', img:"https://raw.githubusercontent.com/ChrisCrossAT/website/main/event-early-16x9-1600w.avif"},
          {label:'1–2 Monate', value:'1to2', img:"https://raw.githubusercontent.com/ChrisCrossAT/website/main/event-middle-16x9-1600w.avif"},
          {label:'> 2 Monate', value:'gt2', img:"https://raw.githubusercontent.com/ChrisCrossAT/website/main/event-late-16x9-1600w.avif"}
      ]},
      { id:'impact', q:'Wie soll die Show sein?', options:[
          {label:'Wow-Moment', value:'Wow', img:"https://raw.githubusercontent.com/ChrisCrossAT/website/main/wow-effect-16x9-1600w.avif"},
          {label:'Tieferer Sinn', value:'Deep', img:"https://raw.githubusercontent.com/ChrisCrossAT/website/main/story-16x9-1600w.avif"},
          {label:'Offen', value:'Offen', ghost:true}
      ]},
      { id:'custom', q:'Konkrete Individualisierungen gewünscht?', options:[
          {label:'Ja', value:'Ja', img:"https://raw.githubusercontent.com/ChrisCrossAT/website/main/individualization-yes-16x9-1600w.avif"},
          {label:'Offen', value:'Offen', ghost:true},
          {label:'Nein', value:'Nein', img:"https://raw.githubusercontent.com/ChrisCrossAT/website/main/individualization-no-16x9-1600w.avif"}
      ]},
      { id:'budget', q:'Wo liegt Ihr Budget ungefähr?', options:[
          {label:'bis 1.000 €', value:'b1', img:"https://raw.githubusercontent.com/ChrisCrossAT/website/main/budget-low-16x9-1600w.avif"},
          {label:'bis 3.000 €', value:'b3', img:"https://raw.githubusercontent.com/ChrisCrossAT/website/main/budget-middle-16x9-1600w.avif"},
          {label:'offen', value:'offen', img:"https://raw.githubusercontent.com/ChrisCrossAT/website/main/budget-high-16x9-1600w.avif"}
      ]}
    ];

    // STATE
    const state = {answers:{}, i:0, mode:'steps'};

    const stage = document.getElementById('stage');

    function setProgress(){
      const prog = document.createElement('div');
      prog.className = 'progress';
      const total = STEPS.length;
      for(let j=0;j<total;j++){
        const d = document.createElement('div');
        d.className = 'dot'+(j<=state.i?' active':'');
        prog.appendChild(d);
      }
      return prog;
    }

    function renderStep(){
      if(state.mode!== 'steps') return; // verhindert Anzeige der letzten Frage im Ergebnis
      stage.classList.add('active');
      stage.style.display = 'block';
      stage.innerHTML = '';
      const s = STEPS[state.i];

      // Sticky question
      const q = document.createElement('div');
      q.className = 'question';
      q.innerHTML = `<div class="q-wrap">${s.q}</div>`;
      stage.appendChild(q);

      // Corner controls
      const left = document.createElement('div'); left.className = 'corner left';
      const back = document.createElement('button'); back.className='btn'; back.textContent='Zurück'; back.disabled = state.i===0; back.addEventListener('click', prevStep); left.appendChild(back);
      stage.appendChild(left);

      const right = document.createElement('div'); right.className = 'corner right';
      const off = s.options.find(o=>o.ghost);
      if(off){ const skip = document.createElement('button'); skip.className='btn'; skip.textContent='Offen'; skip.addEventListener('click', ()=>{ state.answers[s.id]=off.value; nextStep(); }); right.appendChild(skip); }
      stage.appendChild(right);

      // Options – full-bleed
      const opts = s.options.filter(o=>!o.ghost);
      const gallery = document.createElement('div');
      gallery.className = 'gallery';
      const vertical = window.innerWidth < 720; if(vertical) gallery.classList.add('vertical');

      opts.forEach(opt=>{
        const a = document.createElement('article'); a.className='option'; a.tabIndex=0;
        a.innerHTML = `
          <img alt="${opt.label}" src="${opt.img}" />
          <div class="opt-center">
            <div class="opt-box">
              <h3 class="opt-title">${opt.label}</h3>
              ${opt.desc?`<div class='opt-desc'>${opt.desc}</div>`:''}
            </div>
          </div>
        `;
        a.addEventListener('click', ()=>{ state.answers[s.id]=opt.value; nextStep(); });
        a.addEventListener('keydown', (e)=>{ if(e.key==='Enter' || e.key===' '){ e.preventDefault(); a.click(); }});
        gallery.appendChild(a);
      });
      stage.appendChild(gallery);

      // Progress
      stage.appendChild(setProgress());

      // MOBILE: make image tiles half as tall so next option is clearly visible
      if(gallery.classList.contains('vertical')){
        const count = opts.length; // typically 2 or 3
        const frac = (count===2)?0.23:(count===3?0.16:0.22); // smaller heights
        const qh = stage.querySelector('.q-wrap')?.getBoundingClientRect().height || 56;
        const available = window.innerHeight - qh - 24; // spacing under the question
        const h = Math.max(120, Math.round(available * frac));
        [...gallery.children].forEach(el=>{ el.style.height = h+'px'; });
      }
    }

    function prevStep(){ if(state.i>0){ state.i--; renderStep(); } }
    function nextStep(){ if(state.i < STEPS.length-1){ state.i++; renderStep(); } else { showResults(); } }

    window.addEventListener('resize', ()=>{ if(state.mode==='steps') renderStep(); });

    // ===== FILTER & RANKING =====
    function filterShows(){
      const a = state.answers; let list = [...SHOWS];
      if(a.team && a.team!=='Offen'){ const need = a.team==='Solo'?1:(a.team==='DuoTrio'?3:4); list = list.filter(s=>s.maxDancers>=need); }
      if(a.tech && a.tech!=='Offen'){
        if(a.tech==='HighTech') list = list.filter(s=>s.technik==='Ja' || s.technik==='Beides');
        if(a.tech==='NoTech') list = list.filter(s=>s.technik==='Nein');
      }
      if(a.time==='lt1'){ list = list.filter(s=> s.fertige===true && (s.spontan===true || ['Wenig','Etwas'].includes(s.anforderungen))); }
      else if(a.time==='1to2'){ list = list.filter(s=> s.fertige===true || s.individual==='Nein'); }
      if(a.custom==='Ja') list = list.filter(s=> ['Ja','Beides'].includes(s.individual));
      if(a.custom==='Nein') list = list.filter(s=> ['Nein','Beides'].includes(s.individual));
      if(a.budget==='b1') list = list.filter(s=> s.budget==='Klein');
      if(a.budget==='b3') list = list.filter(s=> ['Klein','Mittel'].includes(s.budget));
      return list;
    }
    function score(list){
      const a = state.answers; return list.map(s=>{ let pts=0;
        if(a.tech==='HighTech' && (s.technik==='Ja'||s.technik==='Beides')) pts+=2;
        if(a.tech==='NoTech' && s.technik==='Nein') pts+=2;
        if(s.fertige) pts+=1; if(['Wenig','Etwas'].includes(s.anforderungen)) pts+=1; if(s.spontan) pts+=1;
        if(a.impact==='Wow' && s.art==='Wow-Effekt') pts+=1; if(a.impact==='Deep' && s.art==='Gemischt') pts+=1;
        if(a.budget==='b1' && s.budget==='Klein') pts+=1; if(a.budget==='b3' && ['Klein','Mittel'].includes(s.budget)) pts+=1;
        return {show:s,score:pts};
      }).sort((x,y)=> y.score - x.score || tieBreak(y.show) - tieBreak(x.show));
    }
    function tieBreak(s){ let t=0; if(s.fertige) t+=2; if(s.anforderungen==='Wenig') t+=1; if(s.spontan) t+=1; return t; }
    function relaxedAlternatives(){ const bak = state.answers; const a = {...state.answers, budget:'offen', custom:'Offen'}; state.answers=a; const list=filterShows(); state.answers=bak; return list; }

    const recGrid = document.getElementById('rec-grid');
    const chosenList = document.getElementById('chosen');
    const selectionCountEl = document.getElementById('selection-count');
    let currentRecommendations = []; let selected = new Set();

    function showResults(){
      state.mode = 'results';
      stage.classList.remove('active');
      stage.style.display = 'none'; // harte Deaktivierung der Stage (fixe Frage verschwindet sicher)
      stage.innerHTML = '';
      document.getElementById('results').style.display = 'block';
      let list = filterShows(); let scored = score(list);
      if(scored.length===0){ const alt = relaxedAlternatives(); if(alt.length>0){ scored = score(alt).slice(0,3); } }
      currentRecommendations = scored.slice(0,3).map(x=>x.show);
      selected = new Set(currentRecommendations.map(r=>r.id));
      renderRecommendations();
      window.scrollTo(0,0);
    }

    function renderRecommendations(){
      recGrid.innerHTML='';
      currentRecommendations.forEach(rec=>{
        const card = document.createElement('article'); card.className='card';
        card.innerHTML = `
          <div class="media"><img alt="${rec.title}" src="${rec.img}" /><span class="badge">Empfehlung</span></div>
          <div class="content">
            <h3 class="title">${rec.title}</h3>
            <p class="desc">${shortDesc(rec)}</p>
            <div class="summary">${meta(rec).map(m=>`<span class='chip'>${m}</span>`).join('')}</div>
          </div>
          <div class="nav">
            <a href="${rec.video || '#'}" class="btn" target="_blank" rel="noopener">Video ansehen</a>
            <label class="chip" style="cursor:pointer"><input type="checkbox" ${selected.has(rec.id)?'checked':''} data-id="${rec.id}" style="margin-right:6px"> auswählen</label>
          </div>`;
        recGrid.appendChild(card);
      });
      recGrid.querySelectorAll('input[type="checkbox"]').forEach(cb=> cb.addEventListener('change',(e)=>{ const id=e.target.getAttribute('data-id'); if(e.target.checked) selected.add(id); else selected.delete(id); renderChosen(); }));
      renderChosen();
    }

    function shortDesc(s){
      if(s.id==='laser-solo') return 'Spektakuläre Laserperformance mit präzisen Choreografien – ideal für Wow-Momente.';
      if(s.id==='led-solo') return 'Dynamische LED-Show mit starken musikalischen Akzenten – kompakt einsetzbar.';
      if(s.id==='mapping-solo') return 'Tanz trifft Projektion: storygetrieben; stärkere Wirkung mit längerer Vorlaufzeit.';
      if(s.id==='led-group') return 'LED-Ensemble für größere Bühnen – starke visuelle Akzente und Gruppendynamik.';
      if(s.id==='urban-solo') return 'Reine Tanzkraft ohne Spezialtechnik – schnell und flexibel umsetzbar.';
      if(s.id==='urban-group') return 'Urban Dance Ensemble – kraftvoll, choreografisch dicht, vielseitig skalierbar.';
      if(s.id==='custom') return 'Individuell konzipierte Show – maximaler Fit zur Marke/Story (mehr Vorlauf nötig).';
      if(s.id==='lederhose') return 'Tradition trifft Urban Dance – mitreißender Publikumsmagnet, ideal für Events in AT/DE.';
      if(s.id==='breaking') return 'Battle-getriebene Breaking-Show – energiegeladen, publikumsnah, ohne Spezialtechnik.';
      return 'Hochwertiger Showact von Chris Cross.';
    }
    function meta(s){ const m=[]; m.push(s.maxDancers<=1?'Solo':(s.maxDancers<=3?'Duo/Trio':'Gruppe')); m.push(s.technik==='Nein'?'Tanz pur':'High-Tech'); m.push('Dauer: '+(s.laenge==='Kurz'?'4–6 Min': s.laenge==='Mittel'?'6–8 Min':'8–12 Min')); m.push('Setup: '+s.anforderungen); return m; }
    function renderChosen(){ selectionCountEl.textContent = `${selected.size} ausgewählt`; chosenList.innerHTML=''; currentRecommendations.filter(r=>selected.has(r.id)).forEach(rec=>{ const chip=document.createElement('span'); chip.className='chip'; chip.textContent=rec.title; chosenList.appendChild(chip); }); }

    // ===== FORM =====
    const form = document.getElementById('offer-form');
    const successEl = document.getElementById('success');
    const errorEl = document.getElementById('error');
    function emailValid(v){ return /^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(v); }
    form.addEventListener('submit', async (e)=>{
      e.preventDefault(); successEl.style.display='none'; errorEl.style.display='none';
      const email = document.getElementById('email').value.trim();
      const message = document.getElementById('message').value.trim();
      const honey = document.getElementById('company').value; if(honey){ return; }
      if(!emailValid(email)){ errorEl.textContent='Bitte geben Sie eine gültige E-Mail-Adresse ein.'; errorEl.style.display='block'; return; }
      const payload = { email, message, selections: Array.from(selected), answers: state.answers, page: location.href, ts: new Date().toISOString() };
      if(FORM_ENDPOINT){ try{ const res=await fetch(FORM_ENDPOINT,{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify(payload)}); if(!res.ok) throw new Error('Bad status '+res.status); successEl.style.display='block'; form.reset(); return;}catch(err){ console.error(err);} }
      const subject = encodeURIComponent('Unverbindliche Show-Anfrage');
      const body = encodeURIComponent(['E-Mail: '+email,'Nachricht: '+(message||'-'),'Auswahl: '+Array.from(selected).join(', '),'Antworten: '+JSON.stringify(state.answers)].join('\n'));
      window.location.href = `mailto:${FALLBACK_EMAIL}?subject=${subject}&body=${body}`;
      successEl.style.display='block';
    });
    document.getElementById('mailto-btn').addEventListener('click', ()=>{
      const email = document.getElementById('email').value.trim();
      const message = document.getElementById('message').value.trim();
      const subject = encodeURIComponent('Unverbindliche Show-Anfrage');
      const body = encodeURIComponent(['E-Mail: '+(email||'-'),'Nachricht: '+(message||'-'),'Auswahl: '+Array.from(selected).join(', '),'Antworten: '+JSON.stringify(state.answers)].join('\n'));
      window.location.href = `mailto:${FALLBACK_EMAIL}?subject=${subject}&body=${body}`;
    });

    // Init
    renderStep();
  </script>
</body>
</html>
